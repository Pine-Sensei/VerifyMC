# ----------------------------------------
# General Settings
# ----------------------------------------
# Global language setting. Affects plugin messages and web UI. (e.g., 'zh', 'en')
language: en
# Enable detailed console logs for troubleshooting.
debug: false

# ----------------------------------------
# Web Server
# ----------------------------------------
# The port for the web interface.
web_port: 8080
# The server name displayed on the web interface.
web_server_prefix: '[ Name ]'

# ----------------------------------------
# Verification & Whitelist
# ----------------------------------------
# Supported authentication methods. Options: 'email' (email verification), 'captcha' (graphical captcha).
# You can use multiple methods, e.g.: [email, captcha]
# 
# [IMPORTANT] Configuring the captcha: section below does NOT enable captcha!
# To enable captcha, you MUST add 'captcha' to this list:
#   Captcha only: auth_methods: [captcha]
#   Both email and captcha: auth_methods: [email, captcha]
auth_methods:
  - email
# Maximum number of game accounts that can be linked to a single email address.
max_accounts_per_email: 2
# Whitelist mode: 'bukkit' (syncs with server's whitelist.json) or 'plugin' (uses internal database).
whitelist_mode: plugin
# Registration URL displayed to non-whitelisted players when in 'plugin' mode.
web_register_url: https://domain.com/

# ----------------------------------------
# Registration
# ----------------------------------------
# If true, new user registrations are automatically approved. If false, they require manual admin approval.
register:
  auto_approve: false

# ----------------------------------------
# User & Security
# ----------------------------------------
# A regular expression to validate player names.
username_regex: "^[a-zA-Z0-9_-]{3,16}$"
# If false, usernames that only differ by case (e.g., "Player" and "player") are treated as the same.
username_case_sensitive: false
# The password for accessing the admin panel on the web interface.
admin:
  password: your_custom_password

# ----------------------------------------
# User Notification
# ----------------------------------------
# Send email notification to users when admin reviews their application.
user_notification:
  # Whether to enable user notification feature
  enabled: true
  # Whether to send notification when application is approved
  on_approve: true
  # Whether to send notification when application is rejected
  on_reject: true

# ----------------------------------------
# Frontend (UI)
# ----------------------------------------
frontend:
  # The visual theme for the web interface. Options: 'glassx'.
  theme: glassx
  # URL for the logo. Can be a web link or a local file path (e.g., '/logo.png').
  logo_url: /logo.png
  # A message to display on the homepage.
  announcement: Welcome to [ Name ]!

# ----------------------------------------
# Email (SMTP)
# ----------------------------------------
smtp:
  host: smtp.qq.com
  port: 587
  username: your_email@qq.com
  password: your_email_password
  from: your_email@qq.com
  enable_ssl: true
# Subject (title) of the verification code email
email_subject: VerifyMC Verification Code

# ----------------------------------------
# Auto Update Resources
# ----------------------------------------
# If true, automatically updates i18n files, email templates, and static theme files when the plugin starts.
auto_update_resources: true

# ----------------------------------------
# Email Registration Restrictions
# ----------------------------------------
# Enable email domain whitelist
enable_email_domain_whitelist: true
# Enable email alias limit (e.g. forbid user+xxx@gmail.com)
enable_email_alias_limit: false
# Email domain whitelist. Leave empty to use default mainstream domains
email_domain_whitelist:
  - gmail.com
  - 163.com
  - 126.com
  - qq.com
  - outlook.com
  - hotmail.com
  - icloud.com
  - yahoo.com
  - foxmail.com 

# ----------------------------------------
# Storage
# ----------------------------------------
# Storage type, options: data (local file), mysql (external database)
storage: data
mysql:
  host: localhost
  port: 3306
  database: verifymc
  user: root
  password: yourpassword 

# ----------------------------------------
# Authme Integration Configuration
# ----------------------------------------
authme:
  # Whether to enable Authme integration functionality
  enabled: true
  # Whether to require password input during web registration
  require_password: true
  # Password regex pattern
  password_regex: "^[a-zA-Z0-9_]{8,26}$"
  database:
    # DB type in database mode: mysql / sqlite
    type: sqlite
    table: authme
    # Password format only supports SHA-256 with fixed salt length of 16. If it was not previously using this format, please switch it in AuthMe (AuthMe supports lazy fallback).
    # After switching in AuthMe, please log into the game once to trigger lazy fallback to SHA-256, or you can reset the password directly in the backend.
    # VerifyMC â†” AuthMe bidirectional sync interval (seconds)
    sync_interval_seconds: 30
    mysql:
      host: 127.0.0.1
      port: 3306
      database: authme
      user: root
      password: yourpassword
    sqlite:
      path: plugins/AuthMe/authme.db
    columns:
      mySQLColumnId: id
      # Column for storing or checking players nickname
      mySQLColumnName: username
      # Column for storing or checking players RealName
      mySQLRealName: realname
      # Column for storing players passwords
      mySQLColumnPassword: password
      # Column for storing players passwords salts
      mySQLColumnSalt: ''
      # Column for storing players emails
      mySQLColumnEmail: email
      # Column for storing if a player is logged in or not
      mySQLColumnLogged: isLogged
      # Column for storing if a player has a valid session or not
      mySQLColumnHasSession: hasSession
      # Column for storing the player's last IP
      mySQLColumnIp: ip
      # Column for storing players lastlogins
      mySQLColumnLastLogin: lastlogin
      # Column storing the registration date
      mySQLColumnRegisterDate: regdate
      # Column for storing the IP address at the time of registration
      mySQLColumnRegisterIp: regip
      # Column for storing player LastLocation - X
      mySQLlastlocX: x
      # Column for storing player LastLocation - Y
      mySQLlastlocY: y
      # Column for storing player LastLocation - Z
      mySQLlastlocZ: z
      # Column for storing player LastLocation - World Name
      mySQLlastlocWorld: world
      # Column for storing player LastLocation - Yaw
      mySQLlastlocYaw: yaw
      # Column for storing player LastLocation - Pitch
      mySQLlastlocPitch: pitch
      # Column for storing players uuids (optional)
      mySQLPlayerUUID: ''

# ----------------------------------------
# Captcha Configuration
# ----------------------------------------
# Captcha can be used as an alternative or supplement to email verification
# Add 'captcha' to auth_methods to enable: auth_methods: [captcha]
# Or use both: auth_methods: [email, captcha]
captcha:
  # Captcha type: math (math expression) or text (random characters)
  type: math
  # Length of text captcha (ignored for math type)
  length: 4
  # Captcha expiration time in seconds
  expire_seconds: 300

# ----------------------------------------
# Bedrock Player Support
# ----------------------------------------
# For Geyser/Floodgate bedrock players
bedrock:
  # Whether to enable bedrock player support
  enabled: false
  # Prefix for bedrock players (commonly "." for Floodgate)
  prefix: "."
  # Regex for bedrock usernames
  username_regex: "^[a-zA-Z0-9._-]{3,15}$"

# ----------------------------------------
# Questionnaire Configuration
# ----------------------------------------
# Detailed questions are configured in questionnaire.yml
questionnaire:
  # Whether to enable questionnaire feature
  enabled: false
  # Minimum score to pass
  pass_score: 60
  rate_limit:
    # Time window for rate limiting in milliseconds
    window_ms: 300000
    ip:
      # Maximum submissions allowed per IP within the time window
      max: 20
    uuid:
      # Maximum submissions allowed per Minecraft UUID within the time window
      max: 8
    email:
      # Maximum submissions allowed per email within the time window
      max: 6

# ----------------------------------------
# LLM Essay Scoring (for text questions)
# ----------------------------------------
llm:
  # Enable LLM auto scoring. When disabled, all text questions require manual review
  enabled: true
  # Scoring provider. Options: deepseek / google
  provider: deepseek
  # OpenAI-compatible API base URL, must use https (plugin appends /chat/completions automatically; http:// local proxy endpoints are rejected by ensureHttpsApiBase())
  api_base: https://api.deepseek.com/v1
  # API key
  api_key: ""
  # Model name
  model: deepseek-chat
  # Request timeout in milliseconds
  timeout: 10000
  # Retry count when parsing/network call fails
  retry: 1
  # Maximum concurrent LLM requests (protects API and server load)
  max_concurrency: 4
  # Max wait time to acquire a concurrency slot in milliseconds
  acquire_timeout: 1500
  # Base backoff delay for retries in milliseconds
  retry_backoff_base: 300
  # Maximum backoff delay for retries in milliseconds
  retry_backoff_max: 5000
  # Maximum input length sent to the model in characters
  input_max_length: 2000
  circuit_breaker:
    # Threshold to open circuit breaker (consecutive failures)
    failure_threshold: 5
    # How long the circuit remains open in milliseconds
    open_ms: 30000
  # Fixed system prompt (combined with question, answer and scoring rule)
  system_prompt: |
    You are a fair Minecraft whitelist questionnaire grader.
    Score strictly based on the question, candidate answer, and scoring rule.
    Return JSON only.
  # Scoring rule text appended into the user prompt (can be overridden by question-level scoring_rule in questionnaire.yml)
  scoring_rule: |
    Evaluate primarily:
    1) Relevance to the question
    2) Completeness and level of detail
    3) Understanding of server rules and community norms
  # Expected model output schema (JSON)
  score_format: '{"score": number, "reason": string, "confidence": number}'

# ----------------------------------------
# Discord Integration (OAuth2)
# ----------------------------------------
# Requires creating a Discord application at https://discord.com/developers/applications
discord:
  # Whether to enable Discord integration
  enabled: false
  # Discord application client ID
  client_id: ""
  # Discord application client secret
  client_secret: ""
  # OAuth2 redirect URI
  redirect_uri: "https://yourdomain.com/api/discord/callback"
  # Optional: require users to be in specific guild/server
  guild_id: ""
  # Whether Discord linking is required for registration
  required: false
